{"version":3,"file":"commonHelpers.js","sources":["../src/js/index.js","../src/js/subscription.js","../src/js/ratingPopup.js"],"sourcesContent":["import { queryParamsFilters, queryParamsExercises, refs } from './constants';\nimport { rerender } from './rerender';\nimport {\n  onFilterClick,\n  onPaginationClick,\n  onExerciseClick,\n  onExerciseStartClick,\n} from './eventHandlers';\nimport './search-input';\n\nwindow.matchMedia('(min-width: 768px)').addEventListener('change', e => {\n  if (e.matches) {\n    queryParamsFilters.set('limit', 12);\n    queryParamsExercises.set('limit', 10);\n  } else {\n    queryParamsFilters.set('limit', 9);\n    queryParamsExercises.set('limit', 8);\n  }\n\n  queryParamsFilters.set('page', 1);\n  queryParamsExercises.set('page', 1);\n\n  refs.searchForm.reset();\n  refs.searchForm.classList.add('visually-hidden');\n\n  rerender();\n});\n\nrerender();\n\nrefs.filter.addEventListener('click', onFilterClick);\nrefs.pagination.addEventListener('click', onPaginationClick);\nrefs.list.addEventListener('click', onExerciseClick);\nrefs.exercisesContainer.addEventListener('click', onExerciseStartClick);\n","import { servicePostSubscription } from './services';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const subscribeForm = document.getElementById('subscribeForm');\n  const subscribeBtn = document.getElementById('subscribeBtn');\n\n  subscribeForm.addEventListener('submit', async event => {\n    event.preventDefault();\n\n    const email = subscribeForm.elements['email'].value;\n\n    try {\n      subscribeBtn.disabled = true;\n      subscribeBtn.textContent = 'Subscribing...';\n\n      const response = await servicePostSubscription(email);\n\n      iziToast.success({\n        title: 'Success',\n        message: response.message,\n      });\n    } catch (error) {\n      iziToast.error({\n        title: 'Error',\n        message: error.message,\n      });\n    } finally {\n      subscribeBtn.disabled = false;\n      subscribeBtn.textContent = 'Send';\n      subscribeForm.reset();\n    }\n  });\n});\n","import iziToast from 'izitoast';\nimport { refs } from './constants';\nimport { servicePatchExercisesByIdRating } from './services';\n\nlet activeRating = 0;\nlet exerciseId;\n\nfunction onRatingFormSubmit(e) {\n  e.preventDefault();\n\n  if (activeRating && exerciseId) {\n    servicePatchExercisesByIdRating(exerciseId, {\n      rate: Number(activeRating),\n      email: refs.ratingForm.elements.email.value,\n      review: refs.ratingForm.elements.comment.value,\n    })\n      .then(() => {\n        closeRatingPopUp();\n        iziToast.success({\n          message: 'Thanks for rating!',\n        });\n        refs.ratingForm.reset();\n      })\n      .catch(error => {\n        iziToast.error({\n          message: error.message,\n        });\n      });\n  } else {\n    iziToast.warning({\n      message: 'Please select rating',\n    });\n  }\n}\n\nfunction onStarClick(e) {\n  const currentStar = e.target.closest('.rating-star-container');\n  if (currentStar) {\n    const stars = document.querySelectorAll('.js-rating-star');\n\n    activeRating = currentStar.dataset.id;\n    document.querySelector('.js-rating-label').textContent =\n      Number(activeRating).toFixed(1);\n\n    for (let i = 0; i < activeRating; i++) {\n      stars[i].classList.add('rating-star--active');\n    }\n\n    for (let i = activeRating; i < 5; i++) {\n      stars[i].classList.remove('rating-star--active');\n    }\n  }\n}\n\nfunction onGiveRatingBtnClick() {\n  exerciseId = JSON.parse(\n    document.querySelector('button[data-exercise]').dataset.exercise\n  )._id;\n  refs.exercisePopUpBackdrop.classList.remove('is-open');\n  refs.exercisePopUpBackdrop.style.display = 'none';\n  refs.ratingPopUpBackdrop.classList.add('is-open');\n\n  refs.ratingPopUpContent.innerHTML = createRatingMarkup();\n\n  addRatingPopupListeners();\n}\n\nfunction closeRatingPopUp() {\n  refs.ratingPopUpBackdrop.classList.remove('is-open');\n  refs.exercisePopUpBackdrop.style.display = 'flex';\n  refs.exercisePopUpBackdrop.classList.add('is-open');\n\n  removeRatingPopupListeners();\n}\n\nfunction createRatingStarsMarkup() {\n  // <svg class=\"rating-star rating-star--active\">\n  let starsMarkup = '';\n\n  for (let i = 0; i < 5; i++) {\n    starsMarkup += `\n    <div class=\"rating-star-container\" data-id=\"${i + 1}\">\n      <svg class=\"rating-star js-rating-star\">\n        <use href=\"./images/icons.svg#icon-star\"></use>\n      </svg>\n    </div>`;\n  }\n\n  return `\n    <div class=\"rating rating--dark\">\n      <span class=\"rating-label js-rating-label\">0.0</span>\n        ${starsMarkup}\n      </div>`;\n}\n\nfunction createRatingMarkup() {\n  const ratingStarsMarkup = createRatingStarsMarkup();\n\n  const markup = `\n    <p class=\"rating-data-parameter-name\">Rating</p>\n    <div class=\"rating-rating-wrapper\">\n    <div class=\"dark-container\">\n      <div class=\"sub-container\">\n      ${ratingStarsMarkup}\n      </div>\n    </div>\n    </div>\n  `;\n\n  return markup;\n}\n\nfunction addRatingPopupListeners() {\n  refs.ratingPopUpCloseBtn.addEventListener('click', closeRatingPopUp);\n  refs.ratingPopUpContent.addEventListener('click', onStarClick);\n  refs.ratingForm.addEventListener('submit', onRatingFormSubmit);\n}\n\nfunction removeRatingPopupListeners() {\n  refs.ratingPopUpCloseBtn.removeEventListener('click', closeRatingPopUp);\n  refs.ratingPopUpContent.removeEventListener('click', onStarClick);\n  refs.ratingForm.removeEventListener('submit', onRatingFormSubmit);\n}\n\n// Function to check if the button exists and add the event listener\nfunction checkForButton() {\n  const button = document.querySelector('.js-add-rating');\n  if (button) {\n    button.addEventListener('click', onGiveRatingBtnClick);\n    return true;\n  }\n  return false;\n}\n\n// MutationObserver to monitor DOM changes and check for the button\nconst observer = new MutationObserver(mutations => {\n  mutations.forEach(mutation => {\n    if (mutation.type === 'childList' || mutation.type === 'subtree') {\n      checkForButton();\n    }\n  });\n});\n\n// Start observing the entire document\nobserver.observe(document, {\n  childList: true,\n  subtree: true,\n});\n\n// Initial check in case the button is already present\ncheckForButton();\n"],"names":["e","queryParamsFilters","queryParamsExercises","refs","rerender","onFilterClick","onPaginationClick","onExerciseClick","onExerciseStartClick","subscribeForm","subscribeBtn","event","email","response","servicePostSubscription","iziToast","error","activeRating","exerciseId","onRatingFormSubmit","servicePatchExercisesByIdRating","closeRatingPopUp","onStarClick","currentStar","stars","i","onGiveRatingBtnClick","createRatingMarkup","addRatingPopupListeners","removeRatingPopupListeners","createRatingStarsMarkup","starsMarkup","checkForButton","button","observer","mutations","mutation"],"mappings":"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"}